function log(m,j,p,o,n,k,h,g,f,e,d,c){var l="";for(i=2;i<arguments.length;i++){l=l+arguments[i]+"|||"}var a=decodeURIComponent(escape(getCookie("pin")));var q="#";var b=q.replace(/\$type1\$/,escape(m));b=b.replace(/\$type2\$/,escape(j));b=b.replace(/\$data\$/,escape(l));b=b.replace(/\$pin\$/,escape(a));b=b.replace(/\$referrer\$/,escape(document.referrer));b=b.replace(/\$jinfo\$/,escape(""));$.getJSON(b,function(){})}function clsPVAndShowLog(d,c,a,e){var b=d+"."+a+"."+skutype(c)+"."+e;log("d","o",b)}function clsClickLog(f,d,g,b,a,e){var c=f+"."+b+"."+skutype(d);appendCookie(e,g,c);log("d","o",c+".c")}function appendCookie(reCookieName,sku,key){var reWidsCookies=eval("("+getCookie(reCookieName)+")");if(reWidsCookies==null||reWidsCookies==""){reWidsCookies=new Object()}if(reWidsCookies[key]==null){reWidsCookies[key]=""}var pos=reWidsCookies[key].indexOf(sku);if(pos<0){reWidsCookies[key]=reWidsCookies[key]+","+sku}setCookie(reCookieName,$.toJSON(reWidsCookies),15)}function skutype(b){if(b){var a=b.toString().length;return a==10?1:0}return 0}function setCookie(b,d,a){var c=a;var e=new Date();e.setTime(e.getTime()+c*24*60*60*1000);document.cookie=b+"="+escape(d)+";expires="+e.toGMTString()+";path=/;domain=.#"}function getCookie(b){var a=document.cookie.match(new RegExp("(^| )"+b+"=([^;]*)(;|$)"));if(a!=null){return unescape(a[2])}return null}function clsLog(b,a,e,c,d){appendCookie(d,e,b);e=e.split("#")[0];log(3,b,e)}(function(b){b.fn.imgScroll=function(a,f){var g={evtType:"click",visible:1,direction:"x",next:"#next",prev:"#prev",disableClass:"disabled",disableClassPerfix:false,speed:300,step:1,showControl:false,width:null,height:null,navItems:false,navItmesWrapClass:"scroll-nav-wrap",navItemActivedClass:"current"};var h=b.extend(g,a);return this.each(function(){var O=b(this),J=O.find("ul").eq(0),af=J.find("li"),P=af.length,W=null,aa=null,ab=typeof h.next=="string"?b(h.next):h.next,ad=typeof h.prev=="string"?b(h.prev):h.prev,d=0,V=h.step,ac=h.visible,I=Math.ceil((P-ac)/V)+1,e=h.direction,H=h.evtType,X=h.disableClass,N=h.disableClassPerfix?"prev-"+X:X,L=h.disableClassPerfix?"next-"+X:X,R=h.navItems,U=h.navItmesWrapClass,K=h.navItemActivedClass,M=false,T=true,Q=(P-ac)%V==0;function S(j){if(P>=V+ac){ad.addClass(N);ab.removeClass(L)}else{ab.addClass(L)}if(af.eq(0).css("float")!=="left"){af.css("float","left")}W=h.width||af.eq(0).outerWidth();aa=h.height||af.eq(0).outerHeight();O.css({position:O.css("position")=="static"?"relative":O.css("position"),width:j=="x"?W*ac:W,height:j=="x"?aa:aa*ac,overflow:"hidden"});J.css({position:"absolute",width:j=="x"?W*P:W,height:j=="x"?aa:aa*P,top:0,left:0})}function Y(k,j){if(J.is(":animated")){return false}if(T&&j||M&&!j){return false}else{k=j?--d:++d}J.animate(e=="x"?{left:k>=(I-1)?-(P-ac)*W:-k*V*W}:{top:k>=(I-1)?-(P-ac)*aa:-k*V*aa},a.speed,function(){if(P-k*V<=ac){ab.addClass(L);M=true}else{ab.removeClass(L);M=false}if(k<=0){ad.addClass(N);T=true}else{ad.removeClass(N);T=false}if(R){c(k)}if(typeof f=="function"){f.apply(O,[k,I,af.slice(k*V,k*V+ac),af.slice(k*V+ac-V,k*V+ac)])}})}function ae(j,l){var j=b('<div class="'+j+'"></div>');for(var k=0;k<I;k++){j.append("<em "+(k==0?" class="+l:"")+' title="'+(k+1)+'">'+(k+1)+"</em>")}O.after(j)}function c(j){if(b("."+U).length>0){b("."+U).find("em").removeClass(K).eq(j).addClass(K)}}function Z(){ad.unbind(H).bind(H,function(){Y(d,true)});ab.unbind(H).bind(H,function(){Y(d,false)})}if(P>ac&&ac>=V){S(e);Z();if(R){ae(U,K)}}else{if(h.showControl){ab.add(ad).show()}else{ab.add(ad).hide()}ad.addClass(N);ab.addClass(L)}})}})(jQuery);var ProductTrack=function(d,a,c){this.sRecent=d;this.sGuess=a;this.isBook=c||false;var b='#product-track .nothing{text-align:center;margin-top:100px;}#product-track .iloading{margin-top:100px;}#product-track .m2 h2{padding:0 8px;font:bold 14px/28px simsun;}#product-track .left .m2 .mt{height:28px;line-height:28px;background:url(#/product/skin/2012/i/newicon20121106.png) 0 -287px repeat-x;border:0;border-bottom:1px solid #ccc;padding:0;}#product-track .m2{border:1px solid #CCC;}#product-track .left{float:left;width:210px;margin:0;padding:0;}#product-track .right{float:right;margin:0;padding:0;}#product-track{margin-top:10px;}#product-track .right{width:780px;}#recent-view-track .mc ul{height:250px;overflow-y:auto;}#recent-view-track h2{float:left;font-size:14px;}#recent-view-track .extra{float:right;font-size:12px;margin-right:10px;}#recent-view-track ul{margin-top:-1px;padding:0 8px;}#recent-view-track li{overflow:hidden;border-top:1px dotted #DEDEDE;zoom:1;}#recent-view-track .p-img{float:left;margin-right:5px;width:50px;height:50px;overflow:hidden;}#recent-view-track .p-name{float:left;width:120px;height:3em;margin-top:5px;}#recent-view-track .p-price{float:left;width:120px;}#recent-view-track .no-track{margin:10px;height:230px;background:url(#/product/skin/2012/i/foot.png) left bottom no-repeat;color:#999;}#recent-view-track .no-track p{margin-top:5px;line-height:1.5em;}#recent-view-track .no-track h4{font:18px "microsoft yahei";}#product-track #maybe-like{border-left:0;}#maybe-like .mt{height:28px;background:url(#/product/skin/2012/i/newicon20121106.png) 0 -287px repeat-x;border:0;border-bottom:1px solid #ccc;padding:0;}#maybe-like h2{font-size:14px;float:left;}#maybe-like .extra{float:right;font:12px/29px arial;margin-right:10px;}#maybe-like .extra span{font-family:arial;cursor:pointer;margin:5px 0 0 5px;display:inline-block;height:16px;line-height:16px;padding:0 4px;border-radius:10px;background:#999;color:#fff;*zoom:1;}#maybe-like .extra .curr{background:#d00;}#maybe-like .mc,#recent-view-track .mc{height:250px;overflow:hidden;position:relative;}#maybe-like .p-comm .star{margin-top:2px;}#product-track .star{background-image:url(#/product/skin/2012/i/newicon20121106.png);background-repeat:no-repeat;}#maybe-like .mc li{width:133px;padding:10px 20px;text-align:center;}#maybe-like .mc .p-name{height:3em;}#maybe-like .p-price{height:16px;}#guess-scroll{margin-left:40px;}#maybe-like .disabled{cursor:default;}.guess-control{position:absolute;z-index:1;left:10px;top:70px;display:block;width:21px;height:107px;text-indent:-9999px;overflow:hidden;background:url(#/product/skin/2012/i/scroll.png) 0 0 no-repeat;cursor:pointer;}#guess-backward{background-position:-21px 0;right:10px;left:auto;}#product-track .star{display:inline-block;width:75px;height:14px;}#product-track .sa5{background-position:-109px -239px;}#product-track .sa4{background-position:-124px -239px;}#product-track .sa3{background-position:-139px -239px;}#product-track .sa2{background-position:-154px -239px;}#product-track .sa1{background-position:-169px -239px;}#product-track .sa0{background-position:-184px -239px;}.root61 .right-extra{width:989px;}.root61 #maybe-like .mc li{width:144px;}.root61 #product-track .right{width:1000px;}';this.getStyleRules(b);$(this.sGuess).find("h2").html("\u6839\u636e\u6d4f\u89c8\u4e3a\u6211\u63a8\u8350")};ProductTrack.prototype={hide:function(){$(this.sRecent).hide();$(this.sGuess).hide()},getStyleRules:function(e){var f=document,d=f.getElementsByTagName("head"),b=f.createElement("style"),c=f.createElement("link");if(/\.css$/.test(e)){c.rel="stylesheet";c.type="text/css";c.href=e;if(d.length){d[0].appendChild(c)}else{f.documentElement.appendChild(c)}}else{b.setAttribute("type","text/css");if(b.styleSheet){b.styleSheet.cssText=e}else{var a=f.createTextNode(e);b.appendChild(a)}if(d.length){d[0].appendChild(b)}else{}}},getCommentData:function(a){var b=this;$.ajax({url:"#"+a,dataType:"jsonp",success:function(c){b.setCommentData(c)}})},setCommentData:function(c){var a=c.CommentsCount.length;for(var b=0;b<a;b++){$("#g"+c.CommentsCount[b].SkuId).find(".star").removeClass("sa5").addClass("sa"+c.CommentsCount[b].AverageScore);$("#g"+c.CommentsCount[b].SkuId).find(".p-comm a").html("(\u5df2\u6709"+c.CommentsCount[b].CommentCount+"\u4eba\u8bc4\u4ef7)")}},getData:function(a){var a=a||"#";_this=this;$.ajax({url:a,dataType:"json",success:function(b){_this.setContent(b)},error:function(){_this.hide()}});return this},setContent:function(g,d,b){var l=" onclick=\"clsClickLog('', '', '${list.wid}', 3, ${list_index}, 'rodGlobalHis');\"";var a=" onclick=\"clsClickLog('', '', '${list.wid}', 2, ${list_index}, 'rodGlobalTrack');\"";if(this.isBook){l=" onclick=\"clsLog('${list.topNum}&HomeHis', '', '${list.wid}#${list.wMeprice}', ${list_index}, 'reWidsBookHis');\"";a=" onclick=\"clsLog('${list.topNum}&HomeTrack', '', '${list.wid}#${list.wMeprice}', ${list_index}, 'reWidsBookTrack');\""}if($("#product-track").length>0){$("#product-track").html('<div class="right"> <div id="maybe-like" class="m m2" data-widget="tabs"> <div class="mt"> <h2>\u6839\u636e\u6d4f\u89c8\u731c\u4f60\u559c\u6b22</h2> <div class="extra"> </div> </div> <div class="mc"> <div class="iloading">\u6b63\u5728\u52a0\u8f7d\u4e2d\uff0c\u8bf7\u7a0d\u5019...</div> </div> </div></div><div class="left"> <div id="recent-view-track" class="m m2"> <div class="mt"> <h2>\u6700\u8fd1\u6d4f\u89c8</h2> </div> <div class="mc"> <div class="iloading">\u6b63\u5728\u52a0\u8f7d\u4e2d\uff0c\u8bf7\u7a0d\u5019...</div> </div> </div> </div><span class="clr"></span>')}var f="<ul>	{for list in history}    <li"+l+'>        <div class="p-img">            <a href="${list.productUrl}"><img src="${pageConfig.FN_GetImageDomain(list.wid)}n5/${list.imageUrl}" /></a>        </div>        <div class="p-name">            <a href="${list.productUrl}">${list.wName}</a>        </div>        <div class="p-price">            <img src="#/price/gp${list.wid}-1-1-1.png" onerror="this.src=\'../../skin/e/i/error-3.gif\'" />        </div>    </li>    {/for}	  <li class="all-recent" style="text-align:right;padding:5px 0;"><a href="#/history/list.html" target="_blank" style="color:#005ea7;">\u5168\u90e8\u6d4f\u89c8\u5386\u53f2 <span style="font-family:simsun;">&gt;</span></a></li></ul>';var e='<span class="guess-control" id="guess-forward">&lt;</span><span class="guess-control" id="guess-backward">&gt;</span><div id="guess-scroll"><ul class="lh">{for list in guessyou}<li'+a+' id="g${list.wid}">	<div class="p-img">		<a target="_blank" title="${list.wName}" href="${list.productUrl}"><img height="130" width="130" alt="${list.wName}" src="${pageConfig.FN_GetImageDomain(list.wid)}n3/${list.imageUrl}"></a>	</div>	<div class="p-name">		<a target="_blank" title="${list.wName}" href="${list.productUrl}">${list.wName}</a>	</div>	<div class="p-comm">		<span class="star sa5"></span><br/>		<a target="_blank" href="#m/review/${list.wid}-1-1.html">(\u5df2\u67090\u4eba\u8bc4\u4ef7)</a>	</div>	<div class="p-price">			<img src="#/price/gp${list.wid}-1-1-1.png" onerror="this.src=\'../../skin/e/i/error-3.gif\'" />	</div></li>{/for}</ul></div>';var j=d||f,k=b||e;if(g.history!==null&&g.history.length>0){$(this.sRecent).find(".mc").html(j.process(g));$(this.sRecent).find(".mt").append('<div class="extra"><a href="" target="_blank">\u66f4\u591a</a></div>');if(this.isBook){log("BOOK&HomeHis","Show")}else{clsPVAndShowLog("","",3,"s")}}else{$(this.sGuess).find("h2").html("\u672c\u5468\u70ed\u9500");$(this.sRecent).find(".mc").html('<div class="no-track"><h4>\u60a8\u8fd8\u672a\u5728\u4eac\u4e1c\u7559\u4e0b\u8db3\u8ff9</h4><p>\u5728\u60a8\u7684\u8d2d\u7269\u65c5\u7a0b\u4e2d\uff0c\u60a8\u53ef\u4ee5\u968f\u65f6\u901a\u8fc7\u8fd9\u91cc\u67e5\u770b\u60a8\u4e4b\u524d\u7684\u6d4f\u89c8\u8bb0\u5f55\uff0c\u4ee5\u4fbf\u5feb\u6377\u8fd4\u56de\u60a8\u66fe\u7ecf\u611f\u5174\u8da3\u7684\u9875\u9762\u3002</p></div>')}if(g.guessyou!==null&&g.guessyou.length>0){var c=[];$(this.sGuess).find(".mc").html(e.process(g));$(this.sGuess).find(".mt .extra").html('<a href="" target="_blank">\u66f4\u591a\u63a8\u8350</a>');var h=pageConfig.wideVersion&&!!pageConfig.compatible?5:4;$("#guess-scroll").imgScroll({visible:h,step:h,prev:"#guess-forward",next:"#guess-backward"});if(this.isBook){log("BOOK&HomeTrack","Show")}else{clsPVAndShowLog("","",2,"s")}var m=[];$("#guess-scroll ul li").each(function(){m.push($(this).attr("id"))});this.getCommentData(m.join(",").replace(/g/g,""))}else{$(this.sGuess).find(".mc").html('<div class="nothing">\u6682\u65e0\u63a8\u8350</div>')}}};(function(){var b=document.body.id=="book",a="";if(b){a=""}else{a="";clsPVAndShowLog("","",3,"p");clsPVAndShowLog("","",2,"p")}var c=new ProductTrack("#recent-view-track","#maybe-like",b).getData(a)})();
